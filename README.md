# Boring libjpeg-turbo

This is a slimmed-down fork of the
[libjpeg-turbo](https://github.com/libjpeg-turbo/libjpeg-turbo) code.

It is based on version 2.1.4 (commit 8162eddf, August 2022).

From there, it removes (or modifies, marked with "notboring") a lot of code.
The original libjpeg-turbo library is relatively featureful and flexible. For
example, it allows:

- Arithmetic-coded JPEG images. Even though the relevant patents have finally
  expired, such images are very, very rare in practice.
- Transcoding (e.g. 90 degree rotations) that can be more efficient (and
  'lossless') than a naive "decode RGB + rotate + re-encode YCbCr" workflow.
- Overriding the default malloc-based memory manager, on embedded systems with
  limited physical memory.
- Java bindings for the C library.

Such use cases are rare. This slimmed-down fork only targets those features
used by a modern web browser (e.g. Chromium) on modern, non-embedded hardware
(e.g. 32-bit minimum CPU, 24-bit minimum color display).

For example, our `jconfig.h` file is hard-coded. In the upstream libjpeg-turbo,
it is generated by a user-initiated configuration step.

It's not that library features are bad, per se. *It's that a smaller code base
is easier to understand, customize, audit for security, etc.* If you want the
full feature set, use libjpeg-turbo.

The 'boring' name is inspired by how
[BoringSSL](https://boringssl.googlesource.com/boringssl/) relates to OpenSSL.


## Documentation

The `LICENSE.md` file (and the `README.ijg` file it links to) were copied
unchanged from the upstream libjpeg-turbo repository to this repository but, in
general, see upstream for documentation.

Copied unchanged means that they discuss "libjpeg-turbo" even though this
repository is "boring-libjpeg-turbo".


## Building

Some simple scripts (`./build-boring-x86_64-elf64.sh && ./run-boring-tests.sh
&& ./clean-boring.sh`) are provided as a basic regression-catching check, when
modifying this repository. But we don't otherwise provide build scripts,
makefiles, etc.

For larger Chromium-like projects that want a static library, they already have
their own build system for third party code (and different projects use
different build systems). Use that instead.

For Operating Systems that want to provide a dynamic library, or utility
programs like `cjpeg` and `djpeg`, use the upstream libjpeg-turbo instead. For
example, this repository's `cjpeg` program speaks fewer image file formats than
what many Linux distributions ship as `/usr/bin/cjpeg`. This repository's
`cjpeg` only exists to support the previously mentioned basic regression test.


## Compared to Upstream libjpeg-turbo


### Removed File Format Support

- Arithmetic coding.


### Removed C Library Features

- IDCT scaling.
- Quantization from 24-bit (or 32-bit) to 8-bit color.


### Removed SIMD Code

- i386 (but not x86\_64).
- MIPS.
- MIPS64.
- PowerPC.
